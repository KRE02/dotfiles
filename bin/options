#!/bin/env python
import os, sys, json

def parse_bool(s : str):
    s = s.lower()
    return s == 't' or s == 'true' or s == 'y' or s == 'yes' or s == '1'

try:
    mode = sys.argv[1]
    filename = sys.argv[2]
except:
    print("Invalid arguments")
    sys.exit(1)

if mode == 'get':
    path = sys.argv[3]

    with open(filename, 'r') as f:
        doc = json.loads(f.read())

    for key, value in doc.items():
        if key == path:
            print(f'{value}')

if mode == 'ask':
    outfile = sys.argv[3]

    with open(filename, 'r') as f:
        doc = json.loads(f.read())

    for key, value in doc.items():
        if value == "<?>" or value == "<?str>":
            value = input(f"Set {key}: ")
        if value == "<?num>":
            value = int(input(f"Set {key}: "))
        if value == "<?bool>":
            value = parse_bool(input(f"Set {key} [yN]: "))

        doc[key] = value

    with open(outfile, 'w') as f:
        f.write(json.dumps(doc))
